{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '41633304-c06bc91ac11626a6cec46e525';\n\nexport default async function searchPhotos(search = '', page) {\n  const response = await axios.get(`${BASE_URL}`, {\n    params: {\n      key: API_KEY,\n      q: search,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page,\n    },\n  });\n  return response.data;\n}\n","'use strict';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport default function createMarkup(arr) {\n  if (!arr.length) {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'bottomRight',\n    });\n    return '';\n  }\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class = \"gallery-item\"><a class = \"gallery-link\" href = \"${largeImageURL}\"><img class = \"gallery-image\" src=${webformatURL} alt=\"${tags}\"></a>\n            <div class=\"social-activity\">\n            <ul class=\"social-activity-list\">\n            <li class=\"social-activity-list-item\">Likes <span class=\"number\">${likes}</span></li>\n            <li class=\"social-activity-list-item\">Views <span class=\"number\"> ${views}</span></li>\n            <li class=\"social-activity-list-item\">Comments <span class=\"number\"> ${comments}</span></li>\n            <li class=\"social-activity-list-item\">Downloads <span class=\"number\">${downloads}</span></li>\n            </ul>\n            </div>\n          </li>`\n    )\n    .join('');\n}\n","'use strict';\n\nimport iziToast from 'izitoast';\nimport searchPhotos from './js/pixabay-api';\nimport createMarkup from './js/render-functions';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst list = document.querySelector('.js-list');\nconst button = document.querySelector('.form button');\nconst loadBtn = document.querySelector('.load');\nlet search;\nlet page = 1;\nlet lightbox;\n\nform.addEventListener('submit', handleSubmit);\nloadBtn.addEventListener('click', handleLoad);\n\nasync function handleSubmit(event) {\n  loadBtn.classList.remove('visible');\n  event.preventDefault();\n\n  search = event.target.elements.search.value.trim();\n  if (!search) {\n    return;\n  }\n\n  page = 1;\n  list.innerHTML = '<div class=\"loader\"></div></h1>';\n\n  try {\n    const result = await searchPhotos(search, page);\n    list.innerHTML = createMarkup(result.hits);\n    loadBtn.classList.add('visible');\n    checkLoadMoreButton(result.totalHits);\n    initializeLightbox();\n  } catch (error) {\n    iziToast.error({\n      message: `Error: ${error.message}`,\n      position: 'bottomRight',\n    });\n    list.innerHTML = '<h1>Something went wrong. Please try again.</h1>';\n  }\n\n  form.reset();\n}\n\nfunction initializeLightbox() {\n  lightbox = new SimpleLightbox('.gallery-item a');\n}\n\nlist.addEventListener('click', event => {\n  event.preventDefault();\n  const elem = event.target;\n  if (!elem.tagName === 'IMG' || event.currentTarget === elem) {\n    return;\n  }\n\n  const lightbox = new SimpleLightbox('.gallery-item a');\n  lightbox.refresh();\n});\n\nasync function handleLoad() {\n  if (!search) {\n    return;\n  }\n\n  page++;\n\n  loadBtn.classList.remove('visible');\n\n  if (page > Math.ceil(500 / 15)) {\n    iziToast.show({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'bottomRight',\n    });\n    return;\n  }\n\n  list.insertAdjacentHTML('afterend', '<div class=\"loader\"></div>');\n\n  const loader = document.querySelector('.loader');\n  const card = document.querySelector('.gallery-item');\n\n  try {\n    const result = await searchPhotos(search, page);\n    list.insertAdjacentHTML('beforeend', createMarkup(result.hits));\n    loadBtn.classList.add('visible');\n    loader.remove();\n    const cardHeight = card.getBoundingClientRect().height;\n    window.scrollBy({\n      top: 2 * cardHeight,\n      left: 0,\n      behavior: 'smooth',\n    });\n    lightbox.refresh();\n    checkLoadMoreButton(result.totalHits);\n  } catch (error) {\n    iziToast.error({\n      message: `Error: ${error.message}`,\n      position: 'bottomRight',\n    });\n    list.innerHTML = '<h1>Something went wrong. Please try again.</h1>';\n  }\n}\n\nfunction checkLoadMoreButton(totalHits) {\n  const totalPages = Math.ceil(totalHits / 15);\n  if (page >= totalPages) {\n    loadBtn.classList.remove('visible');\n    iziToast.show({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'bottomRight',\n    });\n  }\n}\n"],"names":["BASE_URL","API_KEY","searchPhotos","search","page","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast","form","list","loadBtn","lightbox","handleSubmit","handleLoad","event","result","checkLoadMoreButton","initializeLightbox","error","SimpleLightbox","elem","loader","card","cardHeight","totalHits","totalPages"],"mappings":"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"}